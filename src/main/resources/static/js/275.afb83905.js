"use strict";(self["webpackChunkrealsocket"]=self["webpackChunkrealsocket"]||[]).push([[275],{8275:function(t,s,e){e.r(s),e.d(s,{default:function(){return b}});var o=function(){var t=this,s=t._self._c;return s("div",[t._v(" 채팅방 목록 "),s("button",{on:{click:t.makeRoom}},[t._v("방 만들기")]),s("hr"),0==t.roomList.length?s("div",[t._v("방없음")]):s("div",t._l(t.roomList,(function(e,o){return s("span",{key:o,staticClass:"room",on:{click:function(s){return t.enterChat(e)}}},[t._v(" "+t._s(e.roomName)),s("br")])})),0)])},r=[],i=(e(7658),e(4311)),n=e(3266),a=e.n(n),c=e(4029),m=e.n(c),h={data(){return{roomList:[]}},created(){this.start()},methods:{start(){this.$store.state.stompClient&&this.subscribeCancel();const t=new(m())("http://3.38.178.54:9998/realsocket/websocket");this.$store.state.stompClient=a().over(t),this.$store.state.stompClient.connect({},(()=>{console.log("야호 연결성공요"),this.subscribeCancel();const t=this.$store.state.stompClient.subscribe("/topic/roomList",(t=>{console.log(t.body),console.log("방리스트를 업데이트 할게요"),this.updateRoomList()}));this.$store.state.subscribeList.push(t),this.updateRoomList()}))},updateRoomList(){i.Z.get("http://3.38.178.54:9998/realsocket/chatingRoomList").then((({data:t})=>{this.roomList=t}))},subscribeCancel(){for(let t of this.$store.state.subscribeList)this.$store.state.stompClient.unsubscribe(t.id);this.$store.state.subscribeList=[]},makeRoom(){var t=prompt("방제목을 입력해주세요");if(t){var s=prompt("닉네임을 입력해주세요");s&&(console.log(t,s),i.Z.post("http://3.38.178.54:9998/realsocket/chatingRoom",{roomName:t,userId:s}).then((({data:e})=>{console.log(e),sessionStorage.setItem("roomNumber",e),this.$store.state.stompClient.send("/socket/roomList"),this.$router.push({path:"/ChatView/"+t+"/"+s})})))}},enterChat(t){console.log(t);var s=prompt("닉네임을 입력해주세요");s&&i.Z.post("http://3.38.178.54:9998/realsocket/enterChat",{roomNumber:t.roomNumber,userId:s}).then((({data:e})=>{sessionStorage.setItem("roomNumber",t.roomNumber),this.$store.state.stompClient.send("/socket/notification/"+sessionStorage.getItem("roomNumber")),this.$router.push({path:"/ChatView/"+e+"/"+s})}))}}},l=h,u=e(1001),p=(0,u.Z)(l,o,r,!1,null,null,null),b=p.exports}}]);
//# sourceMappingURL=275.afb83905.js.map