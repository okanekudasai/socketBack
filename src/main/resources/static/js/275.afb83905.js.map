{"version":3,"file":"js/275.afb83905.js","mappings":"gKAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACF,EAAII,GAAG,YAAYF,EAAG,SAAS,CAACG,GAAG,CAAC,MAAQL,EAAIM,WAAW,CAACN,EAAII,GAAG,WAAWF,EAAG,MAA8B,GAAvBF,EAAIO,SAASC,OAAaN,EAAG,MAAM,CAACF,EAAII,GAAG,SAASF,EAAG,MAAMF,EAAIS,GAAIT,EAAIO,UAAU,SAASG,EAAKC,GAAK,OAAOT,EAAG,OAAO,CAACU,IAAID,EAAIE,YAAY,OAAOR,GAAG,CAAC,MAAQ,SAASS,GAAQ,OAAOd,EAAIe,UAAUL,EAAK,IAAI,CAACV,EAAII,GAAG,IAAIJ,EAAIgB,GAAGN,EAAKO,WAAWf,EAAG,OAAO,IAAG,IACna,EACIgB,EAAkB,G,0DCiBtB,GACAC,OACA,OACAZ,SAAAA,GAEA,EACAa,UACA,YACA,EACAC,QAAAA,CACAC,QACA,sDACA,iEACA,0CACA,sCACA,IACA,KACAC,QAAAA,IAAAA,YAEA,uBACA,uEACAA,QAAAA,IAAAA,EAAAA,MAEAA,QAAAA,IAAAA,kBACA,yBAIA,wCACA,wBAEA,EACAC,iBACAC,EAAAA,EAAAA,IAAAA,sDAAAA,MAAAA,EAAAN,WACA,kBAEA,EACAO,kBACA,6CACA,gDAEA,kCACA,EACApB,WACA,4BACA,MACA,4BACA,IACAiB,QAAAA,IAAAA,EAAAA,GAEAE,EAAAA,EAAAA,KAAAA,iDAAAA,CAAA,8BAAAN,WACAI,QAAAA,IAAAA,GACAI,eAAAA,QAAAA,aAAAA,GAEA,uDAEA,mBAAAC,KAAAA,aAAAA,EAAAA,IAAAA,GAAA,IAXA,CAaA,EACAb,UAAAA,GACAQ,QAAAA,IAAAA,GACA,4BACA,GACAE,EAAAA,EAAAA,KAAAA,+CAAAA,CAAA,2CAAAN,WACAQ,eAAAA,QAAAA,aAAAA,EAAAA,YAEA,iGACA,mBAAAC,KAAAA,aAAAA,EAAAA,IAAAA,GAAA,GAEA,ICxFwP,I,UCQpPC,GAAY,OACd,EACA9B,EACAmB,GACA,EACA,KACA,KACA,MAIF,EAAeW,EAAiB,O","sources":["webpack://realsocket/./src/views/HomeView.vue","webpack://realsocket/src/views/HomeView.vue","webpack://realsocket/./src/views/HomeView.vue?2a07","webpack://realsocket/./src/views/HomeView.vue?aae2"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_vm._v(\" 채팅방 목록 \"),_c('button',{on:{\"click\":_vm.makeRoom}},[_vm._v(\"방 만들기\")]),_c('hr'),(_vm.roomList.length == 0)?_c('div',[_vm._v(\"방없음\")]):_c('div',_vm._l((_vm.roomList),function(room,idx){return _c('span',{key:idx,staticClass:\"room\",on:{\"click\":function($event){return _vm.enterChat(room)}}},[_vm._v(\" \"+_vm._s(room.roomName)),_c('br')])}),0)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div>\n        채팅방 목록\n        <button @click=\"makeRoom\">방 만들기</button>\n        <hr>\n        <div v-if=\"roomList.length == 0\">방없음</div>\n        <div v-else>\n            <span class=\"room\" v-for=\"(room, idx) in roomList\" :key=\"idx\" @click=\"enterChat(room)\">\n                {{room.roomName}}<br>\n            </span>\n        </div>\n    </div>\n</template>\n\n<script>\nimport axios from 'axios'\nimport Stomp from 'webstomp-client'\nimport SockJS from 'sockjs-client'\n\nexport default {\n    data() {\n        return {\n            roomList: [],\n        }\n    },\n    created() {\n        this.start();\n    },\n    methods: {\n        start() {\n            if(this.$store.state.stompClient) this.subscribeCancel();\n            const socket = new SockJS(process.env.VUE_APP_URL + '/realsocket/websocket');\n            this.$store.state.stompClient = Stomp.over(socket);\n            this.$store.state.stompClient.connect(\n                {},\n                () => {\n                console.log(\"야호 연결성공요\")\n                // 모든 구독을 끊어요\n                this.subscribeCancel()\n                const subscribeId = this.$store.state.stompClient.subscribe(\"/topic/roomList\", (e) => {\n                    console.log(e.body)\n                    //이 함수를 써서 vue객체의 룸리스트를 업데이트해요\n                    console.log(\"방리스트를 업데이트 할게요\")\n                    this.updateRoomList();\n                    //e로 던저서 e.body로 받았어요\n                })\n                // 구독 정보를 업데이트해요\n                this.$store.state.subscribeList.push(subscribeId);\n                this.updateRoomList();\n            });\n        },\n        updateRoomList() {\n            axios.get(process.env.VUE_APP_URL + '/realsocket/chatingRoomList').then(({data}) => {\n                this.roomList = data;\n            })\n        },\n        subscribeCancel() {\n            for(let sub of this.$store.state.subscribeList) {\n                this.$store.state.stompClient.unsubscribe(sub.id);\n            }\n            this.$store.state.subscribeList = [];\n        },\n        makeRoom() {\n            var roomName = prompt(\"방제목을 입력해주세요\");\n            if (!roomName) return;\n            var userId = prompt(\"닉네임을 입력해주세요\");\n            if (!userId) return;\n            console.log(roomName, userId)\n            //채팅방이름과 내 닉네임을 가지고 채팅방을 만드는 메서드를 호출해요\n            axios.post(process.env.VUE_APP_URL + '/realsocket/chatingRoom', {\"roomName\": roomName, \"userId\": userId}).then(({data}) => {\n                console.log(data)\n                sessionStorage.setItem(\"roomNumber\", data)\n                // 내가 방을 만든 사실을 계속 방에 있을 구독자들에게 알려줘요\n                this.$store.state.stompClient.send(\"/socket/roomList\")\n                // 채팅방으로 이동해요\n                this.$router.push( {path: '/ChatView/' + roomName + \"/\" + userId} )\n            })\n        },\n        enterChat(room) {\n            console.log(room)\n            var userId = prompt(\"닉네임을 입력해주세요\");\n            if (!userId) return;\n            axios.post(process.env.VUE_APP_URL + '/realsocket/enterChat', {\"roomNumber\": room.roomNumber, \"userId\": userId}).then(({data}) => {\n                sessionStorage.setItem(\"roomNumber\", room.roomNumber);\n                //notification에서 room인스턴스 찾아서 room인스턴스의 users를 return하고 받는 쪽에서는 user를 업데이트\n                this.$store.state.stompClient.send(\"/socket/notification/\" + sessionStorage.getItem(\"roomNumber\"))\n                this.$router.push( {path: '/ChatView/' + data + \"/\" + userId} )\n            })\n        }\n    },\n};\n</script>\n\n<style>\n.room:hover {\n    cursor: pointer;\n}\n</style>\n\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./HomeView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./HomeView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./HomeView.vue?vue&type=template&id=ad0e4ce0&\"\nimport script from \"./HomeView.vue?vue&type=script&lang=js&\"\nexport * from \"./HomeView.vue?vue&type=script&lang=js&\"\nimport style0 from \"./HomeView.vue?vue&type=style&index=0&id=ad0e4ce0&prod&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","_v","on","makeRoom","roomList","length","_l","room","idx","key","staticClass","$event","enterChat","_s","roomName","staticRenderFns","data","created","methods","start","console","updateRoomList","axios","subscribeCancel","sessionStorage","path","component"],"sourceRoot":""}